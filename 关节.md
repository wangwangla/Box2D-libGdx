# 关节

box2d会通过关节将两个刚体绑在一起，使得两个刚体运动在关节的作用下相互制约相互影响形成有规律的运动。
box2Joint的创建方法

- 创建def对象，通过设置属性进行创建

```java
RevoluteJointDef def = new RevoluteJointDef();
def.initialize(box2DImage,body1,new Vector2(10,100));
Constant.world.createJoint(def);
```

说明：Joint and JointDef不会直接创建，它们是虚拟的抽象类，作为父类代码的多态和重构。

属性： 

- BodyA

- BodyB

- CollideConnected:表示关节链接的两个物体之间是否可以发生碰撞模拟，默认为false,不发生碰撞，可以穿透

### 关节的属性

- enableMotor：是否开启马达属性  默认false
- motorSpeed：在刚体运懂情况下，可以到达的最大线速度和最大角速度。
- maxMotorTorque:关节可以施加最大的力。


这个过程中，刚体的角速度和线速度会一直增加，直到motorSpeed属性

另一个属性可以作为旋转摩檫力使用，设置motorspeed属性值为0，maxMotorTorque作用会阻止刚体在原来的状态，直到外力大于maxMotorToorque属性


弹簧属性：

- frequencyHz和damping属性，运行刚体在运动时偏离节点，偏移后会收到一个力，使得它可以回到原来的位置。所以这两个属性就会在影响它。

- frequencyHz:弹簧系统的震动频率，可以看作时弹簧的弹性系数，系数越大，回归的系数就越大。
- dempingRaio:刚体回归节点收到的阻尼，0~1，值越大，阻力越大。

不常使用的

- GetReactionForce()
- GetReactionTorque()

## 鼠标关节

和鼠标是有关联的，可以实现鼠标的拖拽

- bodyA:一个空刚体
- bodyB:另一个
- target:创建关节时，target时bodyB被拖动收到前置的本地锚点，bodyB可以绕着旋转，他是目标位置，
- maxForce:鼠标关节拖拽bodyB时，施加最大的作用力

## PrismaticJointDef

Vector2 axis = new Vector2(6, 0);
//            axis.nor();
//bodyA 固定转轴
//bodyB 运动的
//开始位置
//方向    axis的值，确定了从开始到结束的夹角
pjd.initialize(ground, body, new Vector2(0, 0), axis);

pjd.motorSpeed = 10.0f;
pjd.maxMotorForce = 10000.0f;
pjd.enableMotor = true;
pjd.lowerTranslation = 0;
pjd.upperTranslation = 20.0f;
pjd.enableLimit = true;

m_joint = (PrismaticJoint)world.createJoint(pjd);

### 夹角的确定

axis点和anchor的夹角，作用只的大小没有太大意义的。

内部做了许多的计算 模拟  所以值比较大容易造成抖动

解决方法：将axis直接做成夹角就可以了 axis.nor();转换为向量。
夹角与固定的保持不变，也就是bodyA保持相对不变，bodyA变化了，夹角也会随着变化。

上面主要对角度进行了控制，下来我们对他的范围也进行控制，axis指定了角度，然后按照角度会不断的延申，为了不超出去

- enablLimit:对刚体移动范围是否进行约束，默认为false,true就表示将范围限制在
  
    - lowerTranslation
    - upperTranlation
    

要求：upper大于lower

- referenceAngle：角度差距，他的用法使用三张图来看

  ![image-20210131091157949](images/image-20210131091157949.png)

### 使用场景

固定路径，比如一个人从桥的这一头走到下一头。



### 线性关节

LineJoint他是一个特殊的平行关节，他的特尔二叔之处就是可以绕着anchorB进行旋转。

as有

## RevoluteJoint(旋转关节)

旋转关节，可以看作一个轴，绕着轴旋转的车轮，这个关节 也有限制，比如最大角度，还有夹角。其次还有一些其他的函数。

![image-20210131094859088](images/image-20210131094859088.png)

- 角速度：JointSpeed
- 关节的旋转角：JointAngle
- 当前关节的扭矩力：MotorTorque

通过限制，可以做成跷跷板



### 作用

可以在游戏里面作为车轮。

跷跷板



## DistanceJoint 

距离关节：包含两个节点，分别对应两个刚体，使得各自绕着各自的轴转动，这个两个的距离不变

## WeldJoint粘贴关节

将两个刚体，连接成一个刚体。这个节点就是将它们死死的连接在一起。两个刚体是一样的，但是受到节点限制，使得两个保持不变，看起来像一个整体，如果将节点删除，会将两个分开。分别各自的速度，角速度。

![image-20210131164924894](images/image-20210131164924894.png)

### 使用

那个一个圆旋转的游戏就可以使用它。



## 滑轮节点

滑轮作用：牵引负载   改变施加力  方向





## 柔体实现

weldJoint来实现












